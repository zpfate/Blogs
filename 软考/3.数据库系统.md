# 数据库系统



## 数据库设计

数据库系统 (DataBase System, DBS) 是一个采用了数据库技术，有组织地、动态地存储大量相关联数据，从而方便多用户访问的计算机系统。广义上讲， DBS包括了数据库管理系统(Data Base Management System, DBMS) 。

数据库 (Data Base, DB) 是统一管理的、长期储存在计算机内的，有组织的相关数据的集合。其特点是数据间联系密切、冗余度小、独立性较高、易扩展，并且可为各类用户共享。一般主要指的是存储数据的各种物理设备以及数据本身。

DBMS是数据库系统的核心软件，是由一组相互关联的数据集合和一组用以访问这些数据的软件组成。 

DBMS 功能主要包括**数据定义、数据库操作、数据库运行管理、数据组织、存储和管理、数据库的建立和维护**。

**DBMS 的特点：**

1. 数据结构化且统一管理

2. 有较高的数据独立性

3. 数据控制功能
   * 数据库的安全性（Security）
   * 数据的完整性（Integrality）
   * 并发控制（concurrency control）
   * 故障恢复（recovery from failure）



<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740467470833" alt="image-20250225151109095" style="zoom:50%;" />

**逻辑独立性** 

**物理独立性**

### 关系的三种类型

* 基本关系（又称为基本表或基表）：实际存在的表，实际存储数据的逻辑表示。
* 查询表：查询结果对应的表。
* 视图表：由基表或其他视图表导出的表，本身不独立存储，数据库只存放的意义，常称为虚拟表



### 分布式数据库

分布式数据库特点：

* **数据独立性**：除了数据的逻辑独立性与物理独立性外，还有数据分部独立性（分部透明性）
* **集中与自治共享结合的控制结构**：局部DBMS可以独立管理局部数据库，具有自治功能。系统又设有集中控制机制，协调各局部DBMS工作，执行全局应用
* **适当增加数据冗余度**：不同场地存储同一数据多个副本，提高系统的可靠性和可用性，提高系统性能，
* **全局的一致性、可串行性和可恢复性**



#



<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740468428456" alt="image-20250225152706280" style="zoom:50%;" />



### 两阶段提交协议 2PC





<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740469422628" alt="image-20250225154340704" style="zoom:50%;" />



### 数据库设计过程-需求分析

<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740469527143" alt="image-20250225154525272" style="zoom:50%;" />

### 概念结构设计

抽象出ER图

<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740470232599" alt="image-20250225155710312" style="zoom:50%;" />



### 逻辑结构设计

逻辑结构设计即是在概念结构设计的基础上进行数据模型设计，可以是层次模型、网状模型和关系模型。逻辑结构设计阶段的主要工作步骤包括确定数据模型、将 E-R 图转换成为指定的数据模型、确定完整性约束和确定用户视图。

1. E-R 图转换为关系模式

2. 关系模式规范化

3. 确定完整性约束

4. 确定用户视图

5. 反规范化

   

<img src="https://raw.githubusercontent.com/zpfate/ImageService/master/uPic/1740644050769" alt="image-20250227161406479" style="zoom:50%;" />



### 物理设计

1. 确定数据分布
2. 确定数据的存储结构
3. 确定数据的访问方式



## 关系代数

### 并（Union)

关系R与S具有相同的关系模式，即R与S的元数相同（结构相同）。关系R与S的并由属于R或属于S的元组构成的集合组成，记作 RUS。

### 差（Difference）

关系 R 与 S 具有相同的关系模式，关系 R 与 S 的差是由属于 R 但不属千 S 的元组构成的集合，记作 R-S 

### 交(Intersection)

关系 R 与 S 具有相同的关系模式，关系 R 与 S 的交是由属于 R 同时又属于 S 的元组构成的集合，关系 R 与 S 的交可记为 R ∩ S

### 广义笛卡尔积(Extended Cartesian Product)

两个元数分别为 n 目和 m 目的关系 R 和 S 的广义笛卡尔积是一个 (n+m) 列的元组的集合。元组的前 n 列是关系 R 的一个元组，后 m 列是关系 S 的一个元组，记作 RXS

### 投影(Projection)

投影运算是从关系的垂直方向进行运算，在关系 R 中选择出若干属性列 A 组成新的关系，记作 A(R)

### 选择（Selection）

选择运算是从关系的水平方向进行运算，是从关系 R 中选择满足给定条件的诸元组，记作

### 连接



### 数据模型

数据库的基础结构是数据模型，数据模型三要素：**数据结构、数据操作、数据的约束条件**。

层次模型

网状模型

面向对象模型

关系模型 



### 关系模型 

**目或度（Degree)**：关系模式中属性的个数

**候选码（Candidate Key）**：唯一标识元组，且无冗余

**主码（主键, Primary Key）**：候选键任选一个

**主属性与非主属性（Prime Attribute，Non-Prime Attribute）**：组成候选码的属性就是主属性，其他的就是非主属性

**外码（外键，Foreign Key）**：其它关系的主键

**全码（ALL-Key)**：关系模式的所有属性是这个关系的候选码



### 完整性约束

#### 实体完整性约束

规定基本关系的主属性不本分取空值

#### 参照完整性约束

关系与关系之间的引用，其他关系的主键

#### 用户自定义完整性约束

应用环境决定

#### 触发器





## 关系数据库的规范化

### 函数依赖

在关系模式 *R*(*U*) 中，*X* 和 *Y* 是属性集 *U* 的子集。若对于 *R* 的任意两个元组 *t*1 和 *t*2，只要 t*1[*X*]=*t*2[*X]，就有 *t*1[*Y*]=*t*2[*Y*]，则称 *X* 函数决定 *Y*，记作 *X*→*Y*。

**说明**

- **决定因素**：*X* 称为决定因素。
- **被决定因素**：*Y* 称为被决定因素。
- **完全函数依赖**：若*X*→*Y*，且 *X* 的任何真子集都不能决定 *Y*，则 *Y* 完全函数依赖于 *X*。
- **部分函数依赖**：若*X*→*Y*，但*Y* 不完全函数依赖于 *X*，则 *Y* 部分函数依赖于 *X*。
- **传递函数依赖**：若*X*→*Y* 且*Y*→*Z*，但 *Y*↛*X*，则 *Z* 传递函数依赖于 *X*。





### 范式

#### 第一范式 1NF

关系模式中每一个分量都是不可再分的数据项

#### 第二范式 2NF

在满足1NF的基础上，所有**非主属性**必须**完全函数依赖**于主键（即不能存在部分函数依赖）

#### 第三范式 3NF

在满足2NF的基础上，所有非主属性必须**直接函数依赖**于主键，而不能存在传递函数依赖

#### BC范式 BCNF

在满足3NF的基础上，对于每一个函数依赖*X*→*Y*，*X* 必须是**超键**（即 *X* 能够唯一标识一行）



### 模式分解



## 数据库的控制




## 数据库技术

### NoSql

NoS QL 整体框架分为 4 层，由下至上分为数据持久层 (Data Persi stence) 、数据分布层(Da ta Distribution Model) 、数据逻辑模型层（ Data Logical Model) 和接口层 (Interface), 层次之间相辅相成，协调工作。

分为四种类型：

1. 列式存储数据库 （Cassandra 、 HBase 、 Riak）
2. 键值对存储数据库 （Tokyo Cabi net/T yrant、Redis 、 Voldemort、 Oracle BDB ）
3. 文档型数据库 （如 CouchDB 、MongoDb, 国内也有文档型数据库 Sequoi aDB）
4. 图数据库（Neo4J、 InfoGri d 、 Infinite Graph 等。）





### 并发控制

### 事务管理

### 封锁协议



## 数据故障、数据恢复、数据备份

