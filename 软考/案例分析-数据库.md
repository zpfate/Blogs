# 案例分析-数据库

## 规范化与反规划

> * 系统分析 数据流图 ER图
> * 实体 关系的分析
> * 规范化相关考察
> * 性能提升
> * 反规划技术



### 数据库设计关注的问题

* 性能

  > 

* 数据一致性

  > * 应用程序数据同步
  > * 触发器数据同步
  > * 批处理

* 安全

### 反规划技术手段

* 增加派生性冗余列 （派生指的是可以通过表中其他数据计算得出）
* 增加冗余列 （这里冗余列指的是多个表中有相同的列）
* 重新组表 
* 分割表

反规划的优点：连接操作少，<font color=red>检索快，统计快</font>，需要查的表少，检索容易。

| 反规划缺点                   | 解决方案                                 |      |
| :--------------------------- | :--------------------------------------- | :--- |
| 数据冗余，需要更大存储空间   | 无解                                     |      |
| 插入、更新、删除操作开销更大 | 无解                                     |      |
| 数据不一致                   | 应用程序数据同步修改<br />触发器同步修改 |      |
| 插入和更新代码更加难写       | 无解                                     |      |



## 索引与视图

> * 视图的概念 特点
> * 优势
> * 物化视图

数据库索引：<font color=red> 提升查询效率</font>；<font color=red>降低增删改的效率</font>；一般采用B树/B+树的方式

### 关系的三种类型

#### 基本关系（基本表、基表）

实际存在的表，实际存储数据的逻辑表示

#### 查询表

查询结果对应的表

#### 视图表

由基表或其他视图表导出的表，本身不独立存储，虚表。

**优点：**

* 视图能<font color=red>简化</font>用户的操作
* 视图机制可以使用户以不同的方式查询统一数据
* 视图对数据库重构提供了一定程度的逻辑独立性
* 视图可以对机密的数据提供安全保护<font color=red> **只读不写**</font>

### 物化视图

将视图的内容物理存储起来，其数据随原始表变化，同步更新。

不是虚表了，是实体化视图，本身会存储数据。

原始数据变化了，物化视图会同步更新；更新性能下降。





## 分布式数据库

> * 分布式数据库的概念
> * 特点

 分区  	分表 	分库

### 分区和分表的共性

* 都是针对数据表
* 都是分布式存储策略
* 提升了查询效率
* 降低了频繁I/O压力值

### 分区和分表的差异

分区的逻辑上还是一张表，而分表则是多张表（不能同名）

### 分区

#### 分区方式

| 分区策略 | 分区方式                  |
| -------- | ------------------------- |
| 范围分区 | 按数据范围值来分区        |
| 哈希分区 | 通过对key进行hash运算分区 |
| 列表分区 | 根据某字段值分区          |

#### 分区优点

* 可以存储更多数据
* 数据管理方便
* 精确定位分区查询数据
* 跨多个分区磁盘查询 提高查询吞吐量
* 涉及聚合函数查询，容易合并

### 分库









## NoSql

> * 主从
> * 读写分离

## 内存数据库

> * Redius

